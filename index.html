<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yajiro 35 - Olympic Birthday (Fixed)</title>

    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: radial-gradient(circle at center, #14002b, #000);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: white;
        }

        /* Terminal */
        #terminal {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            background: rgba(0, 0, 0, 0.9);
            color: #00ff88;
            padding: 15px;
            font-family: monospace;
            font-size: 16px;
            box-shadow: 0 2px 15px #00ff88;
            z-index: 100;
            border-bottom: 2px solid #00ff88;
            box-sizing: border-box;
        }

        /* Arena */
        #arena {
            position: relative;
            width: 100vw;
            height: 100vh;
        }

        /* Contenedor del Atleta (Mantiene todo unido) */
        #athlete {
            position: absolute;
            bottom: 100px;
            left: -150px; /* Inicia fuera de pantalla */
            width: 100px;
            height: 100px;
            /* Curva de salto suave */
            transition: transform 0.4s cubic-bezier(0.25, 1, 0.5, 1);
            z-index: 10;
        }

        #runner {
            position: absolute;
            font-size: 70px;
            bottom: 0;
            left: 0;
            /* SOLUCI√ìN: Voltear el emoji para que mire a la derecha */
            transform: scaleX(-1);
        }

        #jersey {
            position: absolute;
            bottom: 25px;
            left: 20px;
            font-size: 18px;
            font-weight: bold;
            color: #ffeb3b;
            text-shadow: 1px 1px 2px #000;
        }

        #torch {
            position: absolute;
            bottom: 50px;
            left: 50px;
            font-size: 35px;
            animation: flame 0.5s infinite alternate;
        }

        @keyframes flame {
            0% { transform: scale(1) rotate(0deg); }
            100% { transform: scale(1.1) rotate(5deg); }
        }

        /* Vallas */
        .hurdle {
            position: absolute;
            bottom: 100px;
            font-size: 50px;
            z-index: 5;
        }

        /* Meta / Pecho de la llama */
        #cauldron {
            position: absolute;
            right: 100px;
            bottom: 90px;
            font-size: 130px;
            z-index: 8;
        }

        #bigFlame {
            position: absolute;
            right: 140px;
            bottom: 220px;
            font-size: 90px;
            display: none;
            animation: flame 0.8s infinite alternate;
            z-index: 9;
        }

        /* N√∫mero 35 Gigante de fondo */
        #bg35 {
            position: absolute;
            top: 45%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 300px;
            font-weight: bold;
            opacity: 0;
            color: #ff9800;
            transition: opacity 2s, text-shadow 2s;
            z-index: 1;
        }

        /* Mensaje Final */
        #message {
            position: absolute;
            top: 75%;
            width: 100%;
            text-align: center;
            font-size: 45px;
            font-weight: bold;
            opacity: 0;
            transition: 2s;
            text-shadow: 0 0 10px #ff9800;
            z-index: 10;
        }

        /* Bot√≥n inicio */
        #startBtn {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 15px 40px;
            font-size: 24px;
            font-weight: bold;
            background: #ff9800;
            color: white;
            border: 2px solid white;
            border-radius: 10px;
            cursor: pointer;
            box-shadow: 0 0 20px #ff9800;
            display: none; /* Se muestra despu√©s de la terminal */
            z-index: 50;
        }
        #startBtn:hover {
            background: #ff5722;
        }

        canvas {
            position: absolute;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: 2;
        }
    </style>
</head>
<body>

<div id="terminal"></div>

<button id="startBtn">üé¨ Iniciar Carrera</button>

<div id="arena">
    <div id="athlete">
        <div id="runner">üèÉ‚Äç‚ôÇÔ∏è</div>
        <div id="jersey">34</div>
        <div id="torch">üî•</div>
    </div>

    <div class="hurdle" style="left: 35%;">üöß</div>
    <div class="hurdle" style="left: 65%;">üöß</div>

    <div id="cauldron">üèÜ</div>
    <div id="bigFlame">üî•</div>

    <div id="bg35">35</div>
    <div id="message">
        üéâ ¬°ORO OL√çMPICO PARA YAJIRO! üéâ<br>
        <span style="font-size: 24px; color: #00ff88;">(Nivel 35 Desbloqueado)</span>
    </div>

    <canvas id="fireworks"></canvas>
</div>

<script>
    const terminal = document.getElementById("terminal");
    const athlete = document.getElementById("athlete");
    const bg35 = document.getElementById("bg35");
    const message = document.getElementById("message");
    const bigFlame = document.getElementById("bigFlame");
    const startBtn = document.getElementById("startBtn");
    const hurdles = document.querySelectorAll(".hurdle");

    // Textos de la terminal
    const logs = [
        "> Inicializando Yajiro Olympic System...",
        "> Identidad verificada: Yair / Yajiro",
        "> Edad actual: 34 a√±os. Condici√≥n: √ìptima.",
        "> Antorcha encendida. Pista despejada.",
        "> Orientando corredor hacia la meta (Derecha)... [OK]",
        "> Preparando salto a Nivel 35..."
    ];

    let logIdx = 0;
    function typeTerminal() {
        if (logIdx < logs.length) {
            terminal.innerHTML += logs[logIdx] + "<br>";
            logIdx++;
            terminal.scrollTop = terminal.scrollHeight; // Auto-scroll
            setTimeout(typeTerminal, 700);
        } else {
            terminal.innerHTML += "> [LISTO] Haz clic en iniciar.<br>";
            startBtn.style.display = "block";
        }
    }
    // Iniciar terminal al cargar
    setTimeout(typeTerminal, 500);

    let pos = -150;
    let jumping = false;
    let runAnimationId;

    /* AUDIO (Melod√≠a de victoria) */
    function playMusic() {
        try {
            const ctx = new (window.AudioContext || window.webkitAudioContext)();
            function tone(freq, duration, time) {
                const osc = ctx.createOscillator();
                const gain = ctx.createGain();
                osc.connect(gain);
                gain.connect(ctx.destination);
                osc.frequency.value = freq;
                osc.type = "square";
                gain.gain.setValueAtTime(0.05, time);
                osc.start(time);
                osc.stop(time + duration);
            }
            let t = ctx.currentTime;
            const melody = [523, 659, 784, 880, 784, 659, 523];
            melody.forEach((n, i) => tone(n, 0.15, t + i * 0.2));
        } catch(e) { console.log("Audio no soportado"); }
    }

    /* Movimiento Inteligente */
    function move() {
        pos += 6; // Velocidad del corredor
        athlete.style.left = pos + "px";

        // Obtener la posici√≥n de la meta
        const cauldronLeft = document.getElementById("cauldron").offsetLeft;

        // Detector de colisi√≥n con vallas para saltar
        hurdles.forEach(hurdle => {
            let hPos = hurdle.offsetLeft;
            // Si est√° cerca de la valla y no est√° saltando, salta
            if (pos > hPos - 100 && pos < hPos && !jumping) {
                jump();
            }
        });

        // Condici√≥n de victoria (llegar a la copa)
        if (pos > cauldronLeft - 80) {
            ignite();
            return;
        }
        runAnimationId = requestAnimationFrame(move);
    }

    /* Salto del atleta completo */
    function jump() {
        if (jumping) return;
        jumping = true;
        athlete.style.transform = "translateY(-130px)"; // Altura del salto
        setTimeout(() => {
            athlete.style.transform = "translateY(0px)";
            // Cooldown ligeramente m√°s largo para evitar saltos dobles accidentales
            setTimeout(() => { jumping = false; }, 200); 
        }, 400); // Tiempo en el aire
    }

    /* Encendido final y cambio al Nivel 35 */
    function ignite() {
        cancelAnimationFrame(runAnimationId);
        bigFlame.style.display = "block";
        document.getElementById("jersey").innerText = "35"; // ¬°Sube de nivel!
        
        // Detener el movimiento horizontal
        athlete.style.left = pos + "px";

        bg35.style.opacity = 1;
        bg35.style.textShadow = "0 0 40px #ffae00, 0 0 80px red";
        message.style.opacity = 1;
        
        playMusic();
        launchFireworks();
    }

    /* Sistema Avanzado de Fuegos Artificiales */
    const canvas = document.getElementById("fireworks");
    const ctx = canvas.getContext("2d");
    let particles = [];

    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    class Particle {
        constructor(x, y, color) {
            this.x = x; this.y = y;
            this.color = color;
            this.radius = Math.random() * 3 + 1;
            const angle = Math.random() * Math.PI * 2;
            const speed = Math.random() * 6 + 3;
            this.vx = Math.cos(angle) * speed;
            this.vy = Math.sin(angle) * speed;
            this.alpha = 1;
            this.decay = Math.random() * 0.02 + 0.015;
            this.gravity = 0.06;
        }
        update() {
            this.vx *= 0.97; // Fricci√≥n
            this.vy *= 0.97;
            this.vy += this.gravity;
            this.x += this.vx;
            this.y += this.vy;
            this.alpha -= this.decay;
        }
        draw(ctx) {
            if (this.alpha <= 0) return;
            ctx.save();
            ctx.globalAlpha = this.alpha;
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
            ctx.fillStyle = this.color;
            ctx.fill();
            ctx.restore();
        }
    }

    function animateFireworks() {
        if (particles.length === 0 && message.style.opacity === "1") {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        } else if (particles.length > 0) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            particles = particles.filter(p => p.alpha > 0);
            particles.forEach(p => { p.update(); p.draw(ctx); });
        }
        requestAnimationFrame(animateFireworks);
    }

    function createExplosion() {
        const x = Math.random() * canvas.width;
        const y = Math.random() * (canvas.height / 2) + 50; // Explota en la mitad superior
        const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#ffffff', '#ff9800'];
        const color = colors[Math.floor(Math.random() * colors.length)];
        for (let i = 0; i < 70; i++) {
            particles.push(new Particle(x, y, color));
        }
    }

    function launchFireworks() {
        animateFireworks();
        // Explosiones iniciales
        createExplosion();
        setTimeout(createExplosion, 300);
        // Bucle de explosiones
        setInterval(createExplosion, 900);
    }

    /* Evento de Inicio */
    startBtn.addEventListener("click", () => {
        startBtn.style.display = "none";
        playMusic(); // Tono de salida
        setTimeout(move, 500);
    });

</script>

</body>
</html>
